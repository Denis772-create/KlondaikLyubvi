@page "/storepanel"
@inject HttpClient Http
@inject IJSRuntime JS
@using Microsoft.JSInterop
@implements IAsyncDisposable

@code {
    class StoreItemDto {
        public int Id { get; set; }
        public string Name { get; set; } = string.Empty;
        public string? Description { get; set; }
        public int Price { get; set; }
        public string Emoji { get; set; } = string.Empty;
    }
    class TemplateItem {
        public string Name { get; set; } = string.Empty;
        public string? Description { get; set; }
        public int Price { get; set; }
        public string Emoji { get; set; } = string.Empty;
    }
    List<StoreItemDto> MyItems = new();
    string NewName = "";
    string? NewDescription;
    int NewPrice = 1;
    string NewEmoji = "ğŸ’–";
    // Emoji picker state
    bool ShowEmojiPickerAdd = false;
    bool ShowEmojiPickerEdit = false;
    int? EmojiEditForId = null;
    string ActiveEmojiCategory = "Ğ›ÑĞ±Ğ¾Ğ²ÑŒ";
    Dictionary<string, string[]> EmojiCategories = new()
    {
        ["Ğ›ÑĞ±Ğ¾Ğ²ÑŒ"] = new [] { "ğŸ˜","ğŸ¥°","ğŸ˜˜","ğŸ˜»","ğŸ’–","ğŸ’—","ğŸ’“","ğŸ’","ğŸ’•","ğŸ’˜","ğŸ’","ğŸ’Ÿ","ğŸ’‹","ğŸ’Œ","ğŸŒ¹","ğŸŒ¸","ğŸ«¶","ğŸ¤","ğŸ©·","ğŸ«¦" },
        ["Ğ­Ğ¼Ğ¾Ñ†Ğ¸Ğ¸"] = new [] { "ğŸ˜Š","ğŸ˜‡","ğŸ˜Œ","ğŸ˜","ğŸ˜‚","ğŸ¤£","ğŸ˜…","ğŸ˜‰","ğŸ¤—","ğŸ™ˆ","ğŸ¥¹","ğŸ˜­","ğŸ¤”","ğŸ¤­","ğŸ¤©","ğŸ¥³" },
        ["Ğ•Ğ´Ğ°"] = new [] { "ğŸ“","ğŸ«","ğŸ°","ğŸ©","ğŸª","ğŸ§","ğŸ¯","ğŸ","ğŸ’","ğŸ‡","ğŸ¥","ğŸ¥","â˜•","ğŸ·" },
        ["Ğ Ğ°Ğ·Ğ½Ğ¾Ğµ"] = new [] { "ğŸ","ğŸ‰","âœ¨","ğŸ”¥","ğŸŒ™","â­","â˜€ï¸","ğŸ›","ğŸ¥","ğŸµ","ğŸ“¸","ğŸ–ï¸" }
    };
    DotNetObjectReference<StorePanel>? _selfRef;
    List<TemplateItem> Templates = new()
    {
        new TemplateItem { Name = "ĞœĞ°ÑÑĞ°Ğ¶ ÑĞ¿Ğ¸Ğ½Ñ‹ (20 Ğ¼Ğ¸Ğ½)", Description = "Ğ Ğ°ÑÑĞ»Ğ°Ğ±Ğ»ÑÑÑ‰Ğ¸Ğ¹ Ğ¼Ğ°ÑÑĞ°Ğ¶ Ğ¾Ñ‚ Ğ»ÑĞ±Ğ¸Ğ¼Ğ¾Ğ³Ğ¾ Ñ‡ĞµĞ»Ğ¾Ğ²ĞµĞºĞ°", Price = 5, Emoji = "ğŸ’†â€â™€ï¸" },
        new TemplateItem { Name = "Ğ—Ğ°Ğ²Ñ‚Ñ€Ğ°Ğº Ğ² Ğ¿Ğ¾ÑÑ‚ĞµĞ»ÑŒ", Description = "ĞšĞ¾Ñ„Ğµ, Ñ‚Ğ¾ÑÑ‚Ñ‹ Ğ¸ ÑƒĞ»Ñ‹Ğ±ĞºĞ°", Price = 4, Emoji = "ğŸ³" },
        new TemplateItem { Name = "Ğ’ĞµÑ‡ĞµÑ€ Ñ„Ğ¸Ğ»ÑŒĞ¼Ğ¾Ğ²", Description = "Ğ’Ñ‹Ğ±Ğ¾Ñ€ Ñ„Ğ¸Ğ»ÑŒĞ¼Ğ°, Ğ¿Ğ»ĞµĞ´ Ğ¸ Ğ¾Ğ±ÑŠÑÑ‚Ğ¸Ñ", Price = 3, Emoji = "ğŸ¥" },
        new TemplateItem { Name = "Ğ¡Ğ¾Ğ²Ğ¼ĞµÑÑ‚Ğ½Ğ°Ñ Ğ²Ğ°Ğ½Ğ½Ğ°", Description = "Ğ¡Ğ²ĞµÑ‡Ğ¸, Ğ¼ÑƒĞ·Ñ‹ĞºĞ° Ğ¸ Ñ€Ğ°ÑÑĞ»Ğ°Ğ±Ğ»ĞµĞ½Ğ¸Ğµ Ğ²Ğ´Ğ²Ğ¾Ñ‘Ğ¼", Price = 7, Emoji = "ğŸ›" },
        new TemplateItem { Name = "Ğ§Ğ°Ğ¹Ğ½Ğ°Ñ Ñ†ĞµÑ€ĞµĞ¼Ğ¾Ğ½Ğ¸Ñ", Description = "Ğ¢Ñ‘Ğ¿Ğ»Ñ‹Ğ¹ Ñ‡Ğ°Ğ¹ Ğ¸ Ğ±ĞµÑĞµĞ´Ğ° Ğ¿Ğ¾ Ğ´ÑƒÑˆĞ°Ğ¼", Price = 2, Emoji = "ğŸµ" },
        new TemplateItem { Name = "ĞŸÑ€Ğ¾Ğ³ÑƒĞ»ĞºĞ° Ğ¿Ğ¾Ğ´ Ğ·Ğ²Ñ‘Ğ·Ğ´Ğ°Ğ¼Ğ¸", Description = "ĞĞµĞ±Ğ¾Ğ»ÑŒÑˆĞ¾Ğ¹ Ğ²ĞµÑ‡ĞµÑ€Ğ½Ğ¸Ğ¹ Ğ¿Ñ€Ğ¾Ğ¼ĞµĞ½Ğ°Ğ´", Price = 2, Emoji = "ğŸŒ™" },
        new TemplateItem { Name = "Ğ”ĞµÑĞµÑ€Ñ‚-ÑÑÑ€Ğ¿Ñ€Ğ¸Ğ·", Description = "Ğ¢Ğ²Ğ¾Ğ¹ Ğ»ÑĞ±Ğ¸Ğ¼Ñ‹Ğ¹ ÑĞ»Ğ°Ğ´ĞºĞ¸Ğ¹ Ğ¿ĞµÑ€ĞµĞºÑƒÑ", Price = 3, Emoji = "ğŸ°" },
        new TemplateItem { Name = "ĞŸĞ°ĞºĞµÑ‚ Ğ¾Ğ±Ğ½Ğ¸Ğ¼Ğ°ÑˆĞµĞº", Description = "10 Ğ¼Ğ¸Ğ½ÑƒÑ‚ ÑĞ°Ğ¼Ñ‹Ñ… Ñ‚Ñ‘Ğ¿Ğ»Ñ‹Ñ… Ğ¾Ğ±ÑŠÑÑ‚Ğ¸Ğ¹", Price = 1, Emoji = "ğŸ¤—" },
        new TemplateItem { Name = "Ğ”Ğ¾Ğ¼Ğ°ÑˆĞ½Ğ¸Ğ¹ SPA", Description = "ĞœĞ°ÑĞ¾Ñ‡ĞºĞ¸, Ğ¼ÑƒĞ·Ñ‹ĞºĞ° Ğ¸ Ğ°Ñ€Ğ¾Ğ¼Ğ°Ñ‚Ğ½Ñ‹Ğµ ÑĞ²ĞµÑ‡Ğ¸", Price = 6, Emoji = "ğŸ§–â€â™€ï¸" },
        new TemplateItem { Name = "ĞŸÑ€Ğ¾Ğ³ÑƒĞ»ĞºĞ° Ñ ĞºĞ¾Ñ„Ğµ", Description = "ĞšĞ¾Ñ„Ğµ Ğ½Ğ°Ğ²Ñ‹Ğ½Ğ¾Ñ Ğ¸ Ñ€Ğ°Ğ·Ğ³Ğ¾Ğ²Ğ¾Ñ€Ñ‹", Price = 2, Emoji = "â˜•" },
        new TemplateItem { Name = "ĞĞ°ÑÑ‚Ğ¾Ğ»ÑŒĞ½Ñ‹Ğµ Ğ¸Ğ³Ñ€Ñ‹", Description = "Ğ˜Ğ³Ñ€Ğ°ĞµĞ¼ Ğ²Ğ´Ğ²Ğ¾Ñ‘Ğ¼ Ğ²ĞµÑ‡ĞµÑ€Ğ¾Ğ¼", Price = 2, Emoji = "ğŸ²" },
        new TemplateItem { Name = "Ğ™Ğ¾Ğ³Ğ° Ğ´Ğ»Ñ Ğ´Ğ²Ğ¾Ğ¸Ñ…", Description = "Ğ›Ñ‘Ğ³ĞºĞ°Ñ Ñ€Ğ°ÑÑ‚ÑĞ¶ĞºĞ° Ğ¸ Ğ´Ñ‹Ñ…Ğ°Ğ½Ğ¸Ğµ", Price = 3, Emoji = "ğŸ§˜â€â™€ï¸" },
        new TemplateItem { Name = "Ğ£Ğ¶Ğ¸Ğ½ Ğ¿Ñ€Ğ¸ ÑĞ²ĞµÑ‡Ğ°Ñ…", Description = "ĞŸÑ€Ğ¾ÑÑ‚Ğ¾Ğ¹ ÑƒĞ¶Ğ¸Ğ½ + ÑĞ²ĞµÑ‡Ğ¸ Ğ¸ Ğ¼ÑƒĞ·Ñ‹ĞºĞ°", Price = 5, Emoji = "ğŸ·" },
        new TemplateItem { Name = "ĞœĞ¸Ğ½Ğ¸-Ğ¿ÑƒÑ‚ĞµÑˆĞµÑÑ‚Ğ²Ğ¸Ğµ", Description = "Ğ¡ÑÑ€Ğ¿Ñ€Ğ¸Ğ·-Ğ¼Ğ°Ñ€ÑˆÑ€ÑƒÑ‚ Ğ¿Ğ¾ Ñ€Ğ°Ğ¹Ğ¾Ğ½Ñƒ", Price = 5, Emoji = "ğŸ§­" },
    };
    int UserId = 0;
    string? Message;
    bool ShowAddModal = false;
    StoreItemDto? EditItem = null;
    string EditName = "";
    string? EditDescription;
    int EditPrice = 1;
    string EditEmoji = "ğŸ’–";
    protected override async Task OnInitializedAsync() {
        var userIdStr = await JS.InvokeAsync<string>("blazorGetCookie", "userId");
        int.TryParse(userIdStr, out UserId);
        await LoadMyItems();
    }
    async Task LoadMyItems() {
        MyItems = await Http.GetFromJsonAsync<List<StoreItemDto>>($"/api/myitems/{UserId}") ?? new();
    }
    void OpenAddModal() {
        ShowAddModal = true;
        NewName = ""; NewDescription = null; NewPrice = 1; NewEmoji = "ğŸ’–";
        Message = null;
    }
    void CloseAddModal() {
        ShowAddModal = false;
        Message = null;
    }
    async Task AddItem() {
        if (MyItems.Any(x => x.Emoji == NewEmoji)) {
            Message = "Ğ”ÑƒĞ±Ğ»Ğ¸ĞºĞ°Ñ‚ emoji!";
            return;
        }
        if (string.IsNullOrWhiteSpace(NewName) || NewPrice < 1 || string.IsNullOrWhiteSpace(NewEmoji)) {
            Message = "Ğ—Ğ°Ğ¿Ğ¾Ğ»Ğ½Ğ¸Ñ‚Ğµ Ğ²ÑĞµ Ğ¿Ğ¾Ğ»Ñ!";
            return;
        }
        var resp = await Http.PostAsJsonAsync("/api/storeitems", new { Name = NewName, Description = NewDescription, Price = NewPrice, Emoji = NewEmoji, UserId });
        if (resp.IsSuccessStatusCode) {
            await LoadMyItems();
            ShowAddModal = false;
            Message = null;
        } else {
            Message = "ĞÑˆĞ¸Ğ±ĞºĞ°!";
        }
    }
    void ApplyTemplate(TemplateItem t)
    {
        NewName = t.Name;
        NewDescription = t.Description;
        NewPrice = t.Price;
        NewEmoji = t.Emoji;
    }
    void ToggleAddEmojiPicker()
    {
        ShowEmojiPickerAdd = !ShowEmojiPickerAdd;
        if (ShowEmojiPickerAdd)
        {
            _selfRef ??= DotNetObjectReference.Create(this);
            JS.InvokeVoidAsync("registerClickOutsideById", "emoji-picker-add", _selfRef);
        }
        else
        {
            JS.InvokeVoidAsync("unregisterClickOutsideById", "emoji-picker-add");
        }
    }
    void ToggleEditEmojiPicker(int itemId)
    {
        if (EmojiEditForId != itemId || !ShowEmojiPickerEdit)
        {
            EmojiEditForId = itemId;
            ShowEmojiPickerEdit = true;
            _selfRef ??= DotNetObjectReference.Create(this);
            JS.InvokeVoidAsync("registerClickOutsideById", $"emoji-picker-edit-{itemId}", _selfRef);
        }
        else
        {
            ShowEmojiPickerEdit = false;
            JS.InvokeVoidAsync("unregisterClickOutsideById", $"emoji-picker-edit-{itemId}");
        }
    }
    void InsertEmojiAdd(string e) { NewEmoji = e; ShowEmojiPickerAdd = false; JS.InvokeVoidAsync("unregisterClickOutsideById", "emoji-picker-add"); }
    void InsertEmojiEdit(string e) { EditEmoji = e; ShowEmojiPickerEdit = false; if (EmojiEditForId != null) JS.InvokeVoidAsync("unregisterClickOutsideById", $"emoji-picker-edit-{EmojiEditForId}"); }
    [JSInvokable]
    public void CloseEmojiPicker()
    {
        if (ShowEmojiPickerAdd || ShowEmojiPickerEdit)
        {
            ShowEmojiPickerAdd = false; ShowEmojiPickerEdit = false; StateHasChanged();
        }
    }
    public ValueTask DisposeAsync()
    {
        _selfRef?.Dispose();
        return ValueTask.CompletedTask;
    }
    StoreItemDto? EditItemLocal = null;
    void StartEdit(StoreItemDto item) {
        EditItemLocal = item;
        EditName = item.Name;
        EditDescription = item.Description;
        EditPrice = item.Price;
        EditEmoji = item.Emoji;
    }
    async Task SaveEdit() {
        if (EditItemLocal == null) return;
        if (MyItems.Any(x => x.Emoji == EditEmoji && x.Id != EditItemLocal.Id)) {
            Message = "Ğ”ÑƒĞ±Ğ»Ğ¸ĞºĞ°Ñ‚ emoji!";
            return;
        }
        var resp = await Http.PutAsJsonAsync($"/api/storeitems/{EditItemLocal.Id}", new { Name = EditName, Description = EditDescription, Price = EditPrice, Emoji = EditEmoji });
        if (resp.IsSuccessStatusCode) {
            await LoadMyItems();
            EditItemLocal = null;
        } else {
            Message = "ĞÑˆĞ¸Ğ±ĞºĞ°!";
        }
    }
    async Task DeleteItem(int id) {
        await Http.DeleteAsync($"/api/storeitems/{id}");
        await LoadMyItems();
    }
}

<div class="max-w-xl mx-auto bg-white/80 rounded-2xl shadow-2xl p-8 mt-10">
    <h1 class="text-2xl font-bold text-pink-700 mb-6 flex items-center gap-2"><span class="text-3xl">ğŸ›’</span> ĞœĞ¾Ğ¸ Ñ‚Ğ¾Ğ²Ğ°Ñ€Ñ‹</h1>
    <div class="flex justify-end mb-6">
        <button class="flex items-center gap-2 px-6 py-3 rounded-2xl bg-pink-500 hover:bg-pink-600 text-white font-bold text-lg shadow transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-pink-300" @onclick="OpenAddModal">
            <span class="text-xl">â•</span> Ğ”Ğ¾Ğ±Ğ°Ğ²Ğ¸Ñ‚ÑŒ Ñ‚Ğ¾Ğ²Ğ°Ñ€
        </button>
    </div>
    @if (ShowAddModal)
    {
        <div class="fixed inset-0 bg-black/40 flex items-center justify-center z-50">
            <div class="bg-white rounded-2xl shadow-2xl p-8 w-full max-w-md text-center mx-2 sm:mx-auto">
                <h2 class="text-xl font-bold mb-3">Ğ”Ğ¾Ğ±Ğ°Ğ²Ğ¸Ñ‚ÑŒ Ñ‚Ğ¾Ğ²Ğ°Ñ€</h2>
                <div class="mb-4">
                    <div class="text-left text-sm text-gray-500 mb-2">Ğ‘Ñ‹ÑÑ‚Ñ€Ñ‹Ğ¹ Ğ²Ñ‹Ğ±Ğ¾Ñ€ Ğ¸Ğ· Ğ¸Ğ´ĞµĞ¹</div>
                    <div class="grid grid-cols-2 gap-2 max-h-40 overflow-y-auto">
                        @foreach (var t in Templates)
                        {
                            <button class="flex items-center gap-2 px-3 py-2 rounded-xl border hover:bg-pink-50 text-left" @onclick="() => ApplyTemplate(t)">
                                <span class="text-xl">@t.Emoji</span>
                                <div class="min-w-0">
                                    <div class="font-semibold truncate">@t.Name</div>
                                    <div class="text-xs text-gray-500 truncate">@t.Description</div>
                                </div>
                                <span class="ml-auto text-pink-600 font-bold text-sm">@t.Price ğŸ’‹</span>
                            </button>
                        }
                    </div>
                </div>
                <div class="flex flex-col gap-2 mb-4 relative">
                    <input class="rounded border px-3 py-2" placeholder="ĞĞ°Ğ·Ğ²Ğ°Ğ½Ğ¸Ğµ" @bind="NewName" />
                    <input class="rounded border px-3 py-2" placeholder="ĞĞ¿Ğ¸ÑĞ°Ğ½Ğ¸Ğµ" @bind="NewDescription" />
                    <input class="rounded border px-3 py-2" type="number" min="1" placeholder="Ğ¦ĞµĞ½Ğ° (ğŸ’‹)" @bind="NewPrice" />
                    <div class="flex items-center gap-2 justify-center">
                        <input class="rounded border px-3 py-2 w-24 text-center" placeholder="Emoji" @bind="NewEmoji" />
                        <button type="button" class="px-3 py-2 rounded-xl bg-pink-100 hover:bg-pink-200" @onclick="ToggleAddEmojiPicker">Ğ’Ñ‹Ğ±Ñ€Ğ°Ñ‚ÑŒ</button>
                    </div>
                    @if (ShowEmojiPickerAdd)
                    {
                        <div id="emoji-picker-add" class="absolute left-1/2 -translate-x-1/2 top-full mt-2 z-50 w-[min(100%,360px)] bg-white rounded-2xl shadow-2xl p-2 border border-pink-100 select-none">
                            <div class="flex gap-1 mb-2 overflow-x-auto">
                                @foreach (var cat in EmojiCategories.Keys)
                                {
                                    var isActive = cat == ActiveEmojiCategory;
                                    <button type="button" class="@(isActive ? "px-3 py-1 rounded-full text-sm whitespace-nowrap bg-pink-500 text-white" : "px-3 py-1 rounded-full text-sm whitespace-nowrap bg-pink-50 text-pink-600 hover:bg-pink-100")" @onclick="() => ActiveEmojiCategory = cat">@cat</button>
                                }
                            </div>
                            <div class="grid grid-cols-8 gap-1 max-h-56 overflow-y-auto text-center">
                                @foreach (var e in EmojiCategories[ActiveEmojiCategory])
                                {
                                    <button type="button" class="text-xl hover:scale-125 transition" @onclick="() => InsertEmojiAdd(e)">@e</button>
                                }
                            </div>
                        </div>
                    }
                </div>
                @if (!string.IsNullOrEmpty(Message))
                {
                    <div class="text-red-500 font-bold mb-2">@Message</div>
                }
                <div class="flex gap-2 justify-center">
                    <button class="bg-pink-500 hover:bg-pink-600 text-white px-6 py-2 rounded-xl font-bold" @onclick="AddItem">Ğ”Ğ¾Ğ±Ğ°Ğ²Ğ¸Ñ‚ÑŒ</button>
                    <button class="bg-gray-200 px-6 py-2 rounded-xl font-bold text-gray-600" @onclick="CloseAddModal">ĞÑ‚Ğ¼ĞµĞ½Ğ°</button>
                </div>
            </div>
        </div>
    }
    <div class="space-y-4 mb-8">
        @foreach (var item in MyItems)
        {
            <div class="flex items-center gap-4 bg-pink-50 rounded-xl p-4 shadow">
                <span class="text-2xl">@item.Emoji</span>
                <div class="flex-1">
                    <div class="font-bold text-pink-700">@item.Name</div>
                    <div class="text-gray-500 text-sm">@item.Description</div>
                    <div class="text-pink-600 font-bold">@item.Price ğŸ’‹</div>
                </div>
                <div class="flex flex-row gap-2 w-full sm:w-auto justify-end items-center">
                    <button class="w-12 h-12 flex items-center justify-center rounded-full bg-blue-500 hover:bg-blue-600 text-white text-2xl shadow transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-blue-300" title="Ğ ĞµĞ´Ğ°ĞºÑ‚Ğ¸Ñ€Ğ¾Ğ²Ğ°Ñ‚ÑŒ" @onclick="() => StartEdit(item)">
                        âœï¸
                    </button>
                    <button class="w-12 h-12 flex items-center justify-center rounded-full bg-red-500 hover:bg-red-600 text-white text-2xl shadow transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-red-300" title="Ğ£Ğ´Ğ°Ğ»Ğ¸Ñ‚ÑŒ" @onclick="() => DeleteItem(item.Id)">
                        ğŸ—‘ï¸
                    </button>
                </div>
            </div>
            @if (EditItemLocal != null && EditItemLocal.Id == item.Id)
            {
                <div class="bg-white rounded-xl shadow p-4 mt-2 flex flex-col gap-2 relative">
                    <input class="rounded border px-3 py-2" placeholder="ĞĞ°Ğ·Ğ²Ğ°Ğ½Ğ¸Ğµ" @bind="EditName" />
                    <input class="rounded border px-3 py-2" placeholder="ĞĞ¿Ğ¸ÑĞ°Ğ½Ğ¸Ğµ" @bind="EditDescription" />
                    <input class="rounded border px-3 py-2" type="number" min="1" placeholder="Ğ¦ĞµĞ½Ğ° (ğŸ’‹)" @bind="EditPrice" />
                    <div class="flex items-center gap-2">
                        <input class="rounded border px-3 py-2 w-24 text-center" placeholder="Emoji" @bind="EditEmoji" />
                        <button type="button" class="px-3 py-2 rounded-xl bg-pink-100 hover:bg-pink-200" @onclick="() => ToggleEditEmojiPicker(item.Id)">Ğ’Ñ‹Ğ±Ñ€Ğ°Ñ‚ÑŒ</button>
                    </div>
                    @if (ShowEmojiPickerEdit && EmojiEditForId == item.Id)
                    {
                        <div id="@($"emoji-picker-edit-{item.Id}")" class="absolute left-1/2 -translate-x-1/2 top-full mt-2 z-50 w-[min(100%,360px)] bg-white rounded-2xl shadow-2xl p-2 border border-pink-100 select-none">
                            <div class="flex gap-1 mb-2 overflow-x-auto">
                                @foreach (var cat in EmojiCategories.Keys)
                                {
                                    var isActive = cat == ActiveEmojiCategory;
                                    <button type="button" class="@(isActive ? "px-3 py-1 rounded-full text-sm whitespace-nowrap bg-pink-500 text-white" : "px-3 py-1 rounded-full text-sm whitespace-nowrap bg-pink-50 text-pink-600 hover:bg-pink-100")" @onclick="() => ActiveEmojiCategory = cat">@cat</button>
                                }
                            </div>
                            <div class="grid grid-cols-8 gap-1 max-h-56 overflow-y-auto text-center">
                                @foreach (var e in EmojiCategories[ActiveEmojiCategory])
                                {
                                    <button type="button" class="text-xl hover:scale-125 transition" @onclick="() => InsertEmojiEdit(e)">@e</button>
                                }
                            </div>
                        </div>
                    }
                    <div class="flex gap-2">
                        <button class="bg-green-500 hover:bg-green-600 text-white px-4 py-2 rounded font-bold" @onclick="SaveEdit">Ğ¡Ğ¾Ñ…Ñ€Ğ°Ğ½Ğ¸Ñ‚ÑŒ</button>
                        <button class="bg-gray-200 px-4 py-2 rounded font-bold" @onclick="() => EditItemLocal = null">ĞÑ‚Ğ¼ĞµĞ½Ğ°</button>
                    </div>
                </div>
            }
        }
    </div>
</div>